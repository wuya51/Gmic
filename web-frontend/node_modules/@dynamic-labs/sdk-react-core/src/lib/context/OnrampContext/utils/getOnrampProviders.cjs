'use client'
'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var _tslib = require('../../../../../_virtual/_tslib.cjs');
var sdkApiCore = require('@dynamic-labs/sdk-api-core');
var walletConnectorCore = require('@dynamic-labs/wallet-connector-core');
var onramp = require('../../../data/api/onramp/onramp.cjs');
var getWalletAdditionalAddressByType = require('../../../utils/functions/getWalletAdditionalAddressByType/getWalletAdditionalAddressByType.cjs');

const DEFAULT_NETWORK = 'evm';
const DEFAULT_CHAIN = '1';
const getOnrampProviders = (_a) => _tslib.__awaiter(void 0, [_a], void 0, function* ({ address, chainName, environmentId, network, primaryWallet, token, tokenAmount, currency, includeDisabled = false, }) {
    var _b;
    const tempChainNameToUse = (primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.chain)
        ? (_b = walletConnectorCore.getChainInfo(primaryWallet.chain)) === null || _b === void 0 ? void 0 : _b.name
        : undefined;
    const chainNameToUse = chainName !== null && chainName !== void 0 ? chainName : tempChainNameToUse;
    const bitcoinAddress = primaryWallet &&
        walletConnectorCore.isBitcoinConnector(primaryWallet.connector) &&
        getWalletAdditionalAddressByType.getWalletAdditionalAddressByType(sdkApiCore.WalletAddressType.Payment, primaryWallet);
    const chainHasNetwork = network && chainNameToUse === DEFAULT_NETWORK;
    let networkToUse;
    if (chainHasNetwork) {
        networkToUse = (network === null || network === void 0 ? void 0 : network.toString()) || DEFAULT_CHAIN;
    }
    else {
        networkToUse = undefined;
    }
    if (!chainNameToUse || (!(primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.address) && !address)) {
        return [];
    }
    const walletAddress = address || bitcoinAddress || (primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.address);
    if (!walletAddress)
        return [];
    const providers = yield onramp.getOnrampProviders({
        chain: chainNameToUse,
        currency,
        environmentId,
        includeDisabled,
        networkId: networkToUse,
        token,
        tokenAmount,
        walletAddress,
    });
    return providers || [];
});

exports.getOnrampProviders = getOnrampProviders;
