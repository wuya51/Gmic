Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sr25519=void 0;let _1=require("./"),utils_1=require("@noble/hashes/utils"),common_1=require("./common");class Sr25519{constructor(e,r){this.NATIVE=e,this.URL=r}async initKeygen(){var e=await(await this.NATIVE).initKeygen();return new _1.Sr25519InitKeygenResult(e.pubkey,e.keypair)}async exportID(e){e="string"==typeof e?e:e.secretShare;return(await this.NATIVE).sr25519GetExportID(e)}async createRoom(e,r){return(0,common_1.sanitizeNumberOfParties)(e),(await this.NATIVE).createRoom(this.URL,e,r)}async keygen(e,r,t,s,i){if((0,common_1.sanitizeNumberOfParties)(r,t),i.length!==r-1)throw new Error(`keygenIds length must be exactly: ${r-1}, it is: `+i.length);e=await(await this.NATIVE).sr25519Keygen(e,this.URL,r,t,s.keygenSecret,i);if(e.pubkey&&e.secret_share)return r=(0,utils_1.hexToBytes)(e.pubkey),t=e.secret_share,new _1.Sr25519KeygenResult(r,t);throw new Error("Keygen failed, no public key or secret share was returned.")}async sign(e,r,t,s=[]){"string"!=typeof t&&(t=(0,utils_1.bytesToHex)(t));r="string"==typeof r?r:r.secretShare,e=await(await this.NATIVE).sr25519Sign(e,this.URL,r,t,Array.from(s));return(0,utils_1.hexToBytes)(e)}async refresh(e,r){var r="string"==typeof r?r:r.secretShare,e=await(await this.NATIVE).sr25519Refresh(e,this.URL,r);if(e.pubkey&&e.secret_share)return r=(0,utils_1.hexToBytes)(e.pubkey),e=e.secret_share,new _1.Sr25519KeygenResult(r,e);throw new Error("Keygen failed, no public key or secret share was returned.")}async reshareNewParty(e,r,t,s,i){e=await(await this.NATIVE).sr25519ReshareNewParty(e,this.URL,r,t,s.keygenSecret,i),r=(0,utils_1.hexToBytes)(e.pubkey),t=e.secret_share;return new _1.Sr25519KeygenResult(r,t)}async reshareRemainingParty(e,r,t,s){t="string"==typeof t?t:t.secretShare,e=await(await this.NATIVE).sr25519ReshareRemainingParty(e,this.URL,r,t,s),r=(0,utils_1.hexToBytes)(e.pubkey),t=e.secret_share;return new _1.Sr25519KeygenResult(r,t)}async derivePubkey(e,r=[]){e="string"==typeof e?e:e.secretShare,e=await(await this.NATIVE).sr25519DerivePubkey(e,Array.from(r));return(0,utils_1.hexToBytes)(e)}async getPubkey(e){e="string"==typeof e?e:e.secretShare,e=await(await this.NATIVE).sr25519GetPubkey(e);return(0,utils_1.hexToBytes)(e)}async derivePubkeyFromPubkey(e,r){e=await(await this.NATIVE).sr25519DerivePubkeyFromPubkey((0,utils_1.bytesToHex)(e),Array.from(r));return(0,utils_1.hexToBytes)(e)}async exportFullPrivateKey(e,r,t){r="string"==typeof r?r:r.secretShare,e=await(await this.NATIVE).sr25519ExportFullPrivateKey(e,this.URL,r,t);return e||void 0}async derivePrivateKeyFromPrivateKey(e,r,t=[]){return(await this.NATIVE).sr25519DerivePrivateKeyFromPrivateKey(e,Array.from(t),r)}async offlineExportFullPrivateKey(e){e=e.map(e=>{if("string"==typeof e)return e;if(e instanceof _1.Sr25519KeygenResult)return e.secretShare;throw"UnknownType"});return(await this.NATIVE).sr25519OfflineExportFullPrivateKey(e)}async importPrivateKeyRecipient(e,r,t,s){e=await(await this.NATIVE).sr25519ImportPrivateKeyRecipient(e,this.URL,r,t.keygenSecret,s),r=(0,utils_1.hexToBytes)(e.pubkey),t=e.secret_share;return new _1.Sr25519KeygenResult(r,t)}async importPrivateKeyImporter(e,r,t,s,i,a=!1){e=await(await this.NATIVE).sr25519ImportPrivateKeyImporter(e,this.URL,r,t,s.keygenSecret,i,a),r=(0,utils_1.hexToBytes)(e.pubkey),t=e.secret_share;return new _1.Sr25519KeygenResult(r,t)}}exports.Sr25519=Sr25519;