import {
  createHash,
  p256
} from "./chunk-347VRUTM.js";
import {
  uint8ArrayToHexString
} from "./chunk-TJGQWPPV.js";
import "./chunk-XK3CLVBG.js";
import "./chunk-VS2X32LD.js";
import "./chunk-CVK6YDBK.js";

// node_modules/@turnkey/api-key-stamper/dist/purejs.mjs
var signWithApiKey = async (input) => {
  const publicKey = p256.getPublicKey(input.privateKey, true);
  const publicKeyString = uint8ArrayToHexString(publicKey);
  if (publicKeyString != input.publicKey) {
    throw new Error(`Bad API key. Expected to get public key ${input.publicKey}, got ${publicKeyString}`);
  }
  const hash = createHash().update(input.content).digest();
  const signature = p256.sign(hash, input.privateKey);
  return signature.toDERHex();
};
export {
  signWithApiKey
};
//# sourceMappingURL=purejs-PZQFAR7N.js.map
