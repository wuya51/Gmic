Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExportableEd25519=void 0;let _1=require("./"),utils_1=require("@noble/hashes/utils"),common_1=require("./common");class ExportableEd25519{constructor(e,t){this.NATIVE=e,this.URL=t}async initKeygen(){var e=await(await this.NATIVE).initKeygen();return new _1.ExportableEd25519InitKeygenResult(e.pubkey,e.keypair)}async exportID(e){e="string"==typeof e?e:e.secretShare;return(await this.NATIVE).exportableEd25519GetExportID(e)}async createRoom(e,t){return(0,common_1.sanitizeNumberOfParties)(e),(await this.NATIVE).createRoom(this.URL,e,t)}async sampleKey(e,t,r,a,s){if((0,common_1.sanitizeNumberOfParties)(t,r),s.length!==t-1)throw new Error(`keygenIds length must be exactly: ${t-1}, it is: `+s.length);e=await(await this.NATIVE).exportableEd25519SampleKey(e,this.URL,t,r,a.keygenSecret,s);if(e.pubkey&&e.secret_share)return t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share,new _1.ExportableEd25519KeygenResult(t,r);throw new Error("Key sampling failed, no public key or secret share was returned.")}async receiveKey(e,t,r,a,s){if((0,common_1.sanitizeNumberOfParties)(t,r),s.length!==t-1)throw new Error(`keygenIds length must be exactly: ${t-1}, it is: `+s.length);e=await(await this.NATIVE).exportableEd25519ReceiveKey(e,this.URL,t,r,a.keygenSecret,s);if(e.pubkey&&e.secret_share)return t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share,new _1.ExportableEd25519KeygenResult(t,r);throw new Error("Key receive failed, no public key or secret share was returned.")}async sign(e,t,r){"string"!=typeof r&&(r=(0,utils_1.bytesToHex)(r));t="string"==typeof t?t:t.secretShare,e=await(await this.NATIVE).exportableEd25519Sign(e,this.URL,t,r);return(0,utils_1.hexToBytes)(e)}async refresh(e,t){var t="string"==typeof t?t:t.secretShare,e=await(await this.NATIVE).exportableEd25519Refresh(e,this.URL,t);if(e.pubkey&&e.secret_share)return t=(0,utils_1.hexToBytes)(e.pubkey),e=e.secret_share,new _1.ExportableEd25519KeygenResult(t,e);throw new Error("Keygen failed, no public key or secret share was returned.")}async reshareNewParty(e,t,r,a,s){e=await(await this.NATIVE).exportableEd25519ReshareNewParty(e,this.URL,t,r,a.keygenSecret,s),t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share;return new _1.ExportableEd25519KeygenResult(t,r)}async reshareRemainingParty(e,t,r,a){r="string"==typeof r?r:r.secretShare,e=await(await this.NATIVE).exportableEd25519ReshareRemainingParty(e,this.URL,t,r,a),t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share;return new _1.ExportableEd25519KeygenResult(t,r)}async getPrivateKey(e){e="string"==typeof e?e:e.secretShare;return(await this.NATIVE).exportableEd25519GetPubkey(e)}async exportFullPrivateKey(e,t,r){t="string"==typeof t?t:t.secretShare,e=await(await this.NATIVE).exportableEd25519ExportFullPrivateKey(e,this.URL,t,r);return e||void 0}async offlineExportFullPrivateKey(e){e=e.map(e=>{if("string"==typeof e)return e;if(e instanceof _1.ExportableEd25519KeygenResult)return e.secretShare;throw new Error("UnknownType")});return(await this.NATIVE).exportableEd25519OfflineExportFullPrivateKey(e)}async importPrivateKeyRecipient(e,t,r,a){e=await(await this.NATIVE).exportableEd25519ImportPrivateKeyRecipient(e,this.URL,t,r.keygenSecret,a),t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share;return new _1.ExportableEd25519KeygenResult(t,r)}async importPrivateKeyImporter(e,t,r,a,s){e=await(await this.NATIVE).exportableEd25519ImportPrivateKeyImporter(e,this.URL,t,r,a.keygenSecret,s),t=(0,utils_1.hexToBytes)(e.pubkey),r=e.secret_share;return new _1.ExportableEd25519KeygenResult(t,r)}async getPubkey(e){e="string"==typeof e?e:e.secretShare;return(await this.NATIVE).exportableEd25519GetPubkey(e)}}exports.ExportableEd25519=ExportableEd25519;